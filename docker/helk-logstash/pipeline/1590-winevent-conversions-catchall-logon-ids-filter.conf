# HELK logon-ids-conversions filter conf
# HELK build Stage: Alpha
# Author: Nate Guagenti (@neu5ron)
# License: GPL-3.0

filter {
  if [event_id] {
    if [user_logon_id] {
      ruby {
        path => "/usr/share/logstash/pipeline/ruby/id_hex2dec.rb"
        script_params => { "pid" => "user_logon_id" }
        tag_on_exception =>  "_rubyexception-user_logon_id-hex2dec"
        add_field => { "etl_pipeline" => "user_logon_id-hex2dec" }
      }
    }
    if [target_user_logon_id] {
      ruby {
        path => "/usr/share/logstash/pipeline/ruby/id_hex2dec.rb"
        script_params => { "pid" => "target_user_logon_id" }
        tag_on_exception =>  "_rubyexception-target_user_logon_id-hex2dec"
        add_field => { "etl_pipeline" => "target_user_logon_id-hex2dec" }
      }
    }
    if [reporter_logon_id] {
      ruby {
        path => "/usr/share/logstash/pipeline/ruby/id_hex2dec.rb"
        script_params => { "pid" => "reporter_logon_id" }
        tag_on_exception =>  "_rubyexception-reporter_logon_id-hex2dec"
        add_field => { "etl_pipeline" => "reporter_logon_id-hex2dec" }
      }
    }
    if [user_linked_logon_id] {
      ruby {
        path => "/usr/share/logstash/pipeline/ruby/id_hex2dec.rb"
        script_params => { "pid" => "user_linked_logon_id" }
        tag_on_exception =>  "_rubyexception-user_linked_logon_id-hex2dec"
        add_field => { "etl_pipeline" => "user_linked_logon_id-hex2dec" }
      }
    }
    if [SubjectLogonId] {
      ruby {
        path => "/usr/share/logstash/pipeline/ruby/id_hex2dec.rb"
        script_params => { "pid" => "SubjectLogonId" }
        tag_on_exception =>  "_rubyexception-SubjectLogonId-hex2dec"
        add_field => { "etl_pipeline" => "SubjectLogonId-hex2dec" }
      }
    }
    if [TargetLogonId] {
      ruby {
        path => "/usr/share/logstash/pipeline/ruby/id_hex2dec.rb"
        script_params => { "pid" => "TargetLogonId" }
        tag_on_exception =>  "_rubyexception-TargetLogonId-hex2dec"
        add_field => { "etl_pipeline" => "TargetLogonId-hex2dec" }
      }
    }
    if [LogonId] {
      ruby {
        path => "/usr/share/logstash/pipeline/ruby/id_hex2dec.rb"
        script_params => { "pid" => "LogonId" }
        tag_on_exception =>  "_rubyexception-LogonId-hex2dec"
        add_field => { "etl_pipeline" => "LogonId-hex2dec" }
      }
    }
    if [TargetLinkedLogonId] {
      ruby {
        path => "/usr/share/logstash/pipeline/ruby/id_hex2dec.rb"
        script_params => { "pid" => "TargetLinkedLogonId" }
        tag_on_exception =>  "_rubyexception-TargetLinkedLogonId-hex2dec"
        add_field => { "etl_pipeline" => "TargetLinkedLogonId-hex2dec" }
      }
    }
  }
}
