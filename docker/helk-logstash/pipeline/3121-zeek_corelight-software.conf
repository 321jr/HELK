# HELK Zeek and Corelight software log
# HELK build Stage: Alpha
# Author: Nate Guagenti (@neu5ron)
# License: GPL-3.0
  
filter {
  if [event_type] == "zeek" and [event_sub_type] == "software" {

    mutate {
      rename => {
        "host" => "host_ip_addr"
        "host_p" => "dst_port"
        "name" => "zeek_software_name"
        "software_type" => "zeek_software_type"
        "unparsed_version" => "software_name_original"
        "url" => "url_original"
        "version_addl" => "software_version_additional"
        "version_major" => "software_version_major"
        "version_minor" => "software_version_minor1"
        "version_minor2" => "software_version_minor2"
        "version_minor3" => "software_version_minor3"
      }
      add_field => { "etl_pipeline" => "zeek-software-main" }
    }

  }
}