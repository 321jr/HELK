# HELK Zeek and Corelight DHCP log
# HELK build Stage: Alpha
# Author: Nate Guagenti (@neu5ron)
# License: GPL-3.0
  
filter {
  if [event_type] == "zeek" and [event_sub_type] == "dhcp" {

    mutate {
      rename => {
        "agent_remote_id" => "dhcp_agent_remote_id"
        "assigned_addr" => "dhcp_assigned_ip_addr"
        "circuit_id" => "dhcp_circuit_id"
        "client_addr" => "src_ip_addr"
        "client_fqdn" => "src_fqdn"
        "client_message" => "dhcp_client_message"
        "client_software" => "dhcp_client_software"
        "domain" => "src_domain"
        "duration" => "event_duration"
        "host_name" => "src_host_name"
        "lease_time" => "dhcp_lease_time"
        "mac" => "src_mac"
        "msg_orig" => "dhcp_msg_orig"
        "msg_types" => "dhcp_msg_types"
        "requested_addr" => "dhcp_requested_ip_addr"
        "server_addr" => "dst_ip_addr"
        "server_message" => "dhcp_server_message"
        "server_software" => "dhcp_server_software"
        "subscriber_id" => "dhcp_subscriber_id"
      }
      replace => { "event_uid" => "%{zeek_id_uids}" }
      add_field => { "etl_pipeline" => "zeek-dhcp-main" }
    }

  }
}