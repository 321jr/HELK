# HELK Zeek and Corelight DNS log
# HELK build Stage: Alpha
# Author: Nate Guagenti (@neu5ron)
# License: GPL-3.0
  
filter {
  if [event_log_type] == "zeek" and [event_sub_type] == "dns" {

    mutate {
      rename => {
        "AA" => "dns_flags_authoritative"
        "RA" => "dns_flags_recursion_available"
        "RD" => "dns_flags_recursion_desired"
        "TC" => "dns_flags_truncated"
        "TTLs" => "dns_response_ttl"
        "Z" => "dns_flags_z"
        "addl" => "dns_additional_name"
        "answers" => "dns_response_name"
        "auth" => "dns_additional_authoritative_name"
        "proto" => "network_protocol"
        "qclass" => "dns_query_class"
        "qclass_name" => "dns_query_class_name"
        "qtype" => "dns_query_type"
        "qtype_name" => "dns_query_type_name"
        "query" => "dns_query_name"
        "rcode" => "dns_response_code"
        "rcode_name" => "dns_response_code_name"
        "rejected" => "dns_rejected"
        "rtt" => "dns_rtt"
        "trans_id" => "dns_transaction_id"
      }
      add_field => { "etl_pipeline" => "zeek-dns-main" }
    }

  }
}