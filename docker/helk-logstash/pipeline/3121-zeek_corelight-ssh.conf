# HELK Zeek and Corelight SSH log
# HELK build Stage: Alpha
# Author: Nate Guagenti (@neu5ron)
# License: GPL-3.0

filter {
  if [event_log_type] == "zeek" and [event_sub_type] == "ssh" {

    mutate {
      rename => {
        "auth_attempts" => "ssh_auth_attempts"
        "auth_success" => "ssh_auth_success"
        "cipher_alg" => "ssh_cipher_alg"
        "client" => "ssh_client"
        "compression_alg" => "ssh_compression_alg"
        "cshka" => "ssh_cshka"
        "direction" => "ssh_direction"
        "hassh" => "ssh_hassh"
        "hasshAlgorithms" => "ssh_hasshAlgorithms"
        "hasshServer" => "ssh_hasshServer"
        "hasshServerAlgorithms" => "ssh_hasshServerAlgorithms"
        "hasshVersion" => "ssh_hasshVersion"
        "host_key" => "ssh_host_key"
        "host_key_alg" => "ssh_host_key_alg"
      }
      add_field => { "etl_pipeline" => "zeek-ssh-main" }
    }

  }
}